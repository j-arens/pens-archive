window.dpiBlogPosts = [
  {
    date: '2017-05-09 14:14:47',
    title: 'Communion, Community, Mission: Our Easter Meditation',
    imageURL: '//source.unsplash.com/collection/158642',
    excerpt: 'What strange and wonderful days these are, these days between the Resurrection of Christ and His Ascension! He lives, yet is clearly in a bodily form that is not instantly recognizable. He bears the wounds of His crucifixion, yet is able to walk and talk and eat with the Apostles. There is a sense of urgency. From the moment Mary Magdalen rushed from the empty tomb to tell the Apostles that the Lord was not there, to the men on&#8230;',
    content: '<p>I had a doctor appointment on Monday, and as I left the office, I found a brown scapular with an image of Our Lady of Guadalupe. I couldn&#8217;t leave it there, so I picked it up and it&#8217;s now hanging in my work space.</p><p>It&#8217;s certainly true that, for people of other faiths or sects, many Catholic traditions look a little weird. I think the scapular falls into that category. But scapulars have a long, rich history; let&#8217;s explore this tradition a bit.</p>A scapular, historically, was a long piece of cloth that goes over one&#8217;s head, and hangs down the front and back (many religious orders still wear these.) &#8220;Scapular&#8221; comes from the Latin&nbsp;scapula&nbsp;which means &#8220;shoulder.&#8221; That makes sense since the scapular lays on one&#8217;s shoulders. Today, lay people who wear a scapular usually wear one with two small pieces of wool, connected by cord or ribbon, that hangs down one&#8217;s front and back.There are<a href="https://www.catholicculture.org/culture/library/view.cfm?recnum=1312"> many kinds/colors of scapulars</a>. Two popular ones are green scapulars and brown. The green scapular has an image of the Immaculate Heart of Mary and an image of Mary herself, pointing to her Immaculate Heart. Many people relate the green scapular to conversion to a life in Christ. The brown scapular is probably the one most people are familiar with. Tradition says that Mary gave this scapular to St. Simon Stock in the year 1251 AD. Mary&#8217;s promise that accompanies this scapular is that the person who wears it with faith &#8220;<a href="https://www.catholicculture.org/culture/library/view.cfm?recnum=1312">will not suffer everlasting fire</a>.&#8221; That may sound like a &#8220;Get Out of Hell Free&#8221; card, but it&#8217;s not. We must be in a state of grace at the moment of death, regardless of what we are wearing at the time. Scapulars (like rosaries, holy medals, crosses and crucifixes, for instance) are &#8220;sacramentals. &#8220;Sacramentals do not confer the grace of the Holy Spirit in the way that the sacraments do, but by the Church&#8217;s prayer, they prepare us to receive grace and dispose us to cooperate with it. &#8216;For well-disposed members of the faithful, the liturgy of the sacraments and sacramentals sanctifies almost every event of their lives with the divine grace which flows from the Paschal mystery of the Passion, Death, and Resurrection of Christ. From this source all sacraments and sacramentals draw their power.\'&#8221; <a href="http://www.vatican.va/archive/ccc_css/archive/catechism/p2s2c4a1.htm">(CCC 1670</a>) Simply put, a sacramental points us towards and leads us to Christ.Scapulars should be blessed by a priest, and like any sacramental that has been blessed, we take great care in how that object is treated. (That&#8217;s why I picked up that stray scapular they other day!) Once an object is blessed, and is no longer useful (for instance, the cord on a scapular breaks or a prayer book&nbsp;falls apart) the object can either <a href="https://www.fisheaters.com/disposing.html">be buried or burned and then the ashes are buried</a>.Many popes have been great &#8220;fans&#8221; of scapulars, including St. John Paul II:<p><a href="http://www.catholicdigest.com/articles/faith/heritage/2009/01-01/discover-the-secrets-of-the-scapular">Pope John Paul II, who is reported to have worn a brown scapular since he was a boy</a>, insisted doctors not remove his scapular during surgery following the assassination attempt in May 1981. Father Mariano Cera, a Carmelite priest, told Inside the Vatican magazine: &ldquo;Just before the Holy Father was operated on, he told the doctors, &lsquo;Don&rsquo;t take off the scapular.&rsquo; And the surgeons left it on.&rdquo; In his message to the Carmelites at the 750th anniversary of the bestowal of the scapular, Pope John Paul II said those who wear the scapular &mdash; or habit, as he called it &mdash; dedicate themselves to the service of Our Lady for the good of the whole Church. &ldquo;Devotion to her,&rdquo; he continued, &ldquo;cannot be limited to prayers and tributes in her honor on certain occasions, but must become a &lsquo;habit,&rsquo; that is, a permanent orientation of one&rsquo;s own Christian conduct, woven of prayer and interior life, through frequent reception of the sacraments and the concrete practice of the spiritual and corporal works of mercy.&rdquo;</p><p>While scapulars may be unfamiliar to many people (Catholics included!), they are items that can be constant reminders that we &#8220;have put on Christ&#8221; in our baptismal promises. Scapulars, like all sacramentals, can keep us &#8220;tuned in&#8221; to Christ, all day, every day.</p><p>&nbsp;</p><p>Elise Hilton is an author, blogger and speaker. Her role at Diocesan Publications is Editor &amp; Writer with the Marketing Team. She has worked in parish faith formation and Catholic education for over 30&nbsp;years. A passionate student of theology, Elise enjoys sharing her thoughts on parish communication, the role of social media in the Church, Franciscan spirituality and Catholic parenting. To enquire about booking her as a speaker, please contact her at <a href="mailto:ehilton@diocesan.com">ehilton@diocesan.com</a>.</p>'
  },
  {
      date: '2017-05-11 10:48:37',
      title: 'Power To Redeem: The Blood of Jesus',
      imageURL: '//source.unsplash.com/collection/181462',
      excerpt: 'What&#8217;s your type? Anyone who remembers basic biology or who has watched a medical drama knows that humans have different blood types. When someone loses blood due to accident or injury, and that person&#8217;s blood needs to be replaced, the medical team takes care to &#8220;type&#8221; the blood, so as to match it with donated blood. A person given the wrong blood type can potentially lose their life. (Some people, those with &#8220;O&#8221; type blood are universal donors; they can&#8230;',
      content: '<p>What&#8217;s your type?</p><p>Anyone who remembers basic biology or who has watched a medical drama knows that humans have different blood types. When someone loses blood due to accident or injury, and that person&#8217;s blood needs to be replaced, the medical team takes care to &#8220;type&#8221; the blood, so as to match it with donated blood. A person given the wrong blood type can potentially lose their life. (Some people, <a href="http://www.redcrossblood.org/learn-about-blood/blood-types.html">those with &#8220;O&#8221; type blood are universal donors</a>; they can supply blood to any other person, regardless of type.)</p><p>Humans cannot live without blood. Why we were created this way, only God knows, but it is fact. Without blood, we cease to exist.</p><p>As a Church, we are a living organism. We are the Body of Christ. Also, Scripture, Tradition and the saints call the Church the <a href="http://www.vatican.va/archive/ccc_css/archive/catechism/p123a9p2.htm">Bride of Christ</a>:</p><p>The Church is the spotless bride of the spotless Lamb. &#8220;Christ loved the Church and gave himself up for her, that he might sanctify her.&#8221; He has joined her with himself in an everlasting covenant and never stops caring for her as for his own body.</p><p>What one of us would not give our blood for the life of a cherished love one? Many of us donate blood for people we will never meet this side of Heaven. We do this because we understand how vital it is to life.</p><p>Christ: the eternal donor</p><p>Christ knew the value of blood to humanity.&nbsp;He made it clear, at the Last Supper, that he was sacrificing His very Body and Blood for the life of the Church. He poured out that blood the following day, as He was beaten and battered, whipped and kicked, and finally crucified. Monsignor Romano Guardini:</p><p>Christ the intermediary [between us and God the Father] is a sacred living artery through which divine purity and forgiveness flow; through the establishment of the Eucharist he becomes a permanent artery, supplying all the generations with the superabundance of divine life. [The Lord]</p><p>I don&#8217;t know about you, but that puts me into a state of awe: our God has given His very life&#8217;s blood so that we can share in his divinity. As a Church, as baptized Christians, as people of the Eucharist, we receive &#8220;transfusions&#8221; of life and divinity and purity and forgiveness. Christ holds nothing back. Do we hold back? Are we reluctant to give ourselves wholly &nbsp;to Christ, when He has been generous to us?</p><p>St. Catherine of Siena was devoted to the Precious Blood of Christ. <a href="https://www.catholicgallery.org/prayers/prayers-to-blood-of-jesus/">She prayed</a>:</p><p>Precious Blood, ocean of divine mercy: Flow upon us! Precious Blood, most pure offering: Procure us every grace! Precious Blood, hope and refuge of sinners: Atone for us! Precious Blood, delight of holy souls: Draw us! Amen.</p><p>If we cut ourselves off from the &#8220;major artery,&#8221; that is, Christ, we will perish. If we allow ourselves to receive the transfusion of life, offered by Christ, we will have eternal life. It&#8217;s basic biology.</p>'
  },
  {
    date: '2017-05-01 14:33:15',
    title: '5 Things We Can Learn From St. Mark the Evangelist',
    imageURL: '//source.unsplash.com/collection/506238',
    excerpt: 'Tomorrow, April 25, is the feast of St. Mark&nbsp;the Evangelist. The gospel that bears his name is similar in some respects to those of Matthew and Luke, and biblical scholars believe these three accounts of the public life of Jesus&#8217; have a common source, known as the Q document. However, each of these gospels are still distinct. So what can we learn from St. Mark? Mark shows Jesus in a very natural and human light. His gospel&nbsp;tells of Jesus being&#8230;',
    content: '<p>Private Revelations</p><p>There are many people who claim to have what are called &#8220;private revelations&#8221; in the Catholic Church. That is, they believe that God has spoken directly to them with a specific message, that Jesus has appeared or that the Blessed Mother has visited them. The Church takes these claims quite seriously, and will spend many years investigating before declaring such a revelation valid. Even then, no one is&nbsp;required to believe such revelations. <a href="http://www.scborromeo.org/ccc/p1s1c2a1.htm">The Catechism of the Catholic Church states</a>:</p><p>Throughout the ages, there have been so-called &#8220;private&#8221; revelations, some of which have been recognized by the authority of the Church. They do not belong, however, to the deposit of faith. It is not their role to improve or complete Christ&#8217;s definitive Revelation, but to help live more fully by it in a certain period of history. Guided by the Magisterium of the Church, the sensus fidelium knows how to discern and welcome in these revelations whatever constitutes an authentic call of Christ or his saints to the Church.</p><p>Christian faith cannot accept &#8220;revelations&#8221; that claim to surpass or correct the Revelation of which Christ is the fulfillment, as is the case in certain non-Christian religions and also in certain recent sects which base themselves on such &#8220;revelations&#8221;.</p><p>So, if you&#8217;re not captivated by the Shroud of Turin, for examples, or don&#8217;t really wish&nbsp;to go to Lourdes, it&#8217;s ok. You don&#8217;t have to, in order to be a good Catholic.</p><p>Mary at Fatima</p><p>With that said, one of the best-known and perhaps most important revelations took place 100 years ago, in Fatima, Portugal. Mary appeared to three children, Francisco and Jacinta (who were brother and sister), and their cousin, Lucia. The world was enmeshed in World War I, but these children were tucked away, herding sheep as their families eked out meager livings.</p><p>In 1916, the children were visited by three times by St. Michael, who seemingly prepared the children for the appearance of the Blessed Mother. Then, in May of 1917, the Blessed Mother (although she did not specifically identify herself until later that year) <a href="http://www.fatima.org/f4b/complete_fatima_timeline.pdf">appeared to the children</a>:</p><p>Our Lady appears to the three children at the Cova da Iria, a large open field outside the village of Fatima, to ask that they return for five months in succession, on the 13th day of each month, at the same hour. At each apparition, Our Lady requested that the Rosary be prayed every day to obtain peace in the world.</p><p>The children often said the Rosary as they watched over the families&#8217; sheep, but (as kids tend to do!), they used a very quick method. Instead of saying the entire prayer on each bead, they simply said, &#8220;Our Father&#8221; and &#8220;Hail Mary&#8221; and then moved on to the next bead. However, after the apparition of the Lady, they began to pray in earnest.</p><p>While the children tried to keep these appearances a secret, they were in fact just children, and Fatima was a very small place. Each month, on the 13th, the children would go to the cove where Mary had appeared, and each month more and more people came. Lucia was the only one who saw, heard and spoke to Mary. Francisco could see her, but not hear her, and Jacinta could see and hear her, but did not speak.</p><p>In July, Mary allowed the children a vision of Hell:</p><p>&ldquo;You have seen Hell, where the souls of poor sinners go. To save them, God wills to establish in the world devotion to My Immaculate Heart.&rdquo;</p><p>Mary requested that Russia be dedicated to her Immaculate Heart (which happened during the pontificate of St. John Paul II), and also shared what is known as the third secret of Fatima, which Cardinal Ratzinger (who would become Pope Emeritus Benedict XVI) had studied and written about:</p><p>The third part, commonly known as the Third Secret, involves the vision of a post-apocalyptic world in which a future Pope is executed on a hill before a cross outside a devastated city along with priests, bishops, religious and members of the laity. [The text concerning the vision would be published on June 26, 2000, but the words of the Virgin explaining its precise meaning (as She had explained the vision of Hell) and its historical context have yet to be revealed. Sister Lucia&rsquo;s Fourth memoir, however, will reveal that the Virgin&rsquo;s explanation begins with the words: &ldquo;In Portugal the dogma of the Faith will always be preserved,&rdquo; to which Lucia added &ldquo;etc&rdquo; in order to indicate the rest of a yet-tobe-revealed prophecy concerning a crisis of Faith in the Church outside of Portugal accompanied by the apocalyptic outcome depicted in the vision.]</p><p>The Miracle of the Sun</p><p>The culmination of Mary&#8217;s visit to the children was in October 1917. &nbsp;More than 70,000 people were in attendance, reporters and photographers included. Mary reaffirmed her request that the children pray the Rosary daily, and urge others to do the same. Then, the pouring rain that had turned the cove into a muddy mess suddenly stopped:</p><p><a href="http://www.fatima.org/f4b/complete_fatima_timeline.pdf">Some 70,000 people, gathered in the Cova</a> during a driving rain, witness the Miracle of the Sun: the rain suddenly stops; the clouds disappear; and then the sun twirls in the sky, throws off vivid colors, and plunges toward the terrified crowd, instantly drying soaked clothing and the ankle deep mud covering the ground. Many were cured of diseases on the spot, many more converted to the&nbsp;Catholic Faith. Even atheists and anticlerical news reporters, present to scoff at the event, admit that the miracle occurred. Nothing like this miracle, announced in advance, has ever occurred in the history of the world.</p><p>Despite the fact that they were disbelieved by nearly everyone (Lucia reportedly was beaten by her own father), the children never wavered from their story. Mary, the Mother of God, had appeared to them, required penance and prayer for the salvation of the world.</p><p>Sadly, both Francisco and Jacinta died at a very young age (Francisco in 1919 and his sister in 1920.) They offered up their suffering for the world, that sinners would convert. Both have been beatified, and Pope Francis has confirmed that both will be canonized during this anniversary year. Lucia eventually became a Carmelite nun, and lived in a monastery in Coimbra, Portugal until her death in 2005. The cause for her beatification is in the works.</p><p>The Message of Fatima Today</p><p>While many people have a great devotion to Our Lady of Fatima, it seems as though the world is in nearly the same state now as it was when Mary appeared in Fatima. We still need to pray the Rosary, work to convert sinners (ourselves included!) and continue to pray for peace. Images of Christians in Syria, Pakistan, the Sudan and so many other places should compel us to pray for peace. Indeed, Christianity is now <a href="http://www.huffingtonpost.com/kelly-james-clark/christianity-most-persecuted-religion_b_2402644.html">the most persecuted religion in the world</a>. The message of Fatima is needed now more than ever. The 100th anniversary is a great reminder that all of us are called to this message of peace and prayer.</p><p>For more reading on the appearances of Mary in Fatima, and about the children, <a href="https://www.ewtn.com/fatima/index.asp">click here.</a></p><p>&nbsp;</p><p>Elise Hilton is an author, blogger and speaker. Her role at Diocesan Publications is Editor &amp; Writer with the Marketing Team. She has worked in parish faith formation and Catholic education for over 30&nbsp;years. A passionate student of theology, Elise enjoys sharing her thoughts on parish communication, the role of social media in the Church, Franciscan spirituality and Catholic parenting. To enquire about booking her as a speaker, please contact her at <a href="mailto:ehilton@diocesan.com">ehilton@diocesan.com</a>.</p>'
  }
];

window.dpiBlogViewer = (function(posts) {
  
  const state = {
    active: false,
    currentArticle: 0,
    dom: {
      root: null,
      container: null
    }
  };
  
  /**
  * Reset state, and close the viewer
  */
  function _terminate() {
    if (state.active) {
      document.body.removeChild(state.dom.root);
      
      state.active = false;
      state.currentArticle = 0;

      for (let node in state.dom) {
        node = null;
      }
    } else {
      return false;
    }
    
    return true;
  }
  
  /**
  * Scroll to the top of the page
  */
  function _scrollToTop() {
    if (state.dom.root.scrollTop !== 0) {
      state.dom.root.scrollTop-= 100;
      requestAnimationFrame(_scrollToTop);
    } else {
      cancelAnimationFrame(window.dpiBlogAnimationID);
      state.dom.container.classList.remove('dpiBlog-viewer__fx-hide');
    }
  }
  
  /**
  * Re-render the article
  */
  function _reRender(action) {
    if (state.active) {
      if (action === 'next' && state.currentArticle !== posts.length - 1) {
        state.currentArticle++;
        _renderArticle();
      } else if (action === 'prev' && state.currentArticle !== 0) {
        state.currentArticle--;
        _renderArticle();
      }
    } else {
      return false;
    }
    
    state.dom.container.classList.add('dpiBlog-viewer__fx-hide');
    window.dpiBlogAnimationID = requestAnimationFrame(_scrollToTop);
    return true;
  }
  
  /**
  * Route events
  */
  function _handleClick(e) {
    if (e.target.dataset.action) {
      switch (e.target.dataset.action) {
        case 'close':
          return _terminate();
        case 'prev':
          return _reRender('prev');
        case 'next':
          return _reRender('next');
      }
    }
  }
  
  /**
  * Generate the markup for an article control
  */
  function _generateArticleControl(action) {
    if ((action === 'prev' && state.currentArticle !== 0) || (action === 'next' && state.currentArticle !== posts.length - 1)) {
      return `
        <button class="dpiBlog-viewer__nav-btn" data-action="${action}">
          <svg class="dpiBlog-viewer__nav-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 75.6 57.9">
            <path d="M4.5 33.4h55.8L43.5 50.2c-1.8 1.8-1.8 4.6 0 6.4 1.8 1.8 4.6 1.8 6.4 0l24.4-24.4c0.8-0.8 1.3-2 1.3-3.2s-0.5-2.3-1.3-3.2L49.9 1.3C49 0.4 47.9 0 46.7 0s-2.3 0.4-3.2 1.3c-1.8 1.8-1.8 4.6 0 6.4L60.3 24.4H4.5c-2.5 0-4.5 2-4.5 4.5C0 31.4 2 33.4 4.5 33.4z"/>
          </svg>
          <p class="dpiBlog-viewer__nav-title">
            ${action === 'prev' ? posts[state.currentArticle - 1].title : posts[state.currentArticle + 1].title}
          </p>
        </button>
      `;
    }
    
    return '';
  }
  
  /**
  * Convert idx into month string
  */
  function _convertIdxToMonth(idx) {
    switch (idx) {
      case 0:
        return 'January';
      case 1:
        return 'February';
      case 2:
        return 'March';
      case 3:
        return 'April';
      case 4:
        return 'May';
      case 5:
        return 'June';
      case 6:
        return 'July';
      case 7:
        return 'August';
      case 8:
        return 'September';
      case 9:
        return 'October';
      case 10:
        return 'November';
      case 11:
        return 'December';
    }
  }
  
  /**
  * Parse date string into M/dd/yyyy
  */
  function formatDate(str) {
    const date = new Date(str);    
    return `${_convertIdxToMonth(date.getMonth())} ${date.getDate()}, ${date.getFullYear()}`;
  }
  
  /**
  * Render out an article
  */
  function _renderArticle() {
    const post = posts[state.currentArticle];
    state.dom.container.innerHTML = `
      <article class="dpiBlog-viewer__article">
        <time class="dpiBlog-viewer__article-date">${formatDate(post.date)}</time>
        <h1 class="dpiBlog-viewer__article-title">${post.title}</h1>
        <figure class="dpiBlog-viewer__article-img">
          <div class="dpiBlog-viewer__article-img-placeholder" style="background-image: url(${post.imageURL})"></div>
        </figure>
        <div class="dpiBlog-viewer__article-content">
          ${post.content}
          <p class="dpiBlog-viewer__copyright">
            &copy; 2017 <a href="#" class="dpiBlog-viewer__copyright-link">Diocesan Publications</a>
          </p>
        </div>
        <nav class="dpiBlog-viewer__nav">
          ${_generateArticleControl('prev')}
          ${_generateArticleControl('next')}
        </nav>
      </article>
    `;
  }
  
  /**
  * Setup event listeners
  */
  function _bindEvents() {
    try {
      state.dom.root.addEventListener('click', _handleClick);
    } catch(err) {
      console.error('DPI BLOG VIEWER: Unable to bind events!', err);
    }
  }
  
  /**
  * Cache nodes
  */
  function _cacheDom() {
    state.dom.root = document.getElementById('dpiBlog-viewer__root');
    state.dom.container = state.dom.root.querySelector('.dpiBlog-viewer__container');
  }
  
  /**
  * Render out the main viewer component
  */
  function _renderRoot() {
    document.body.insertAdjacentHTML('beforeend', `
      <div id="dpiBlog-viewer__root">
        <button class="dpiBlog-viewer__close-btn" data-action="close">
          <svg class="dpiBlog-viewer__close-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 62.4 62.4">
            <path d="M39.7 31.2l21-21c2.3-2.3 2.3-6.1 0-8.5 -2.3-2.3-6.1-2.3-8.5 0L31.2 22.7 10.2 1.8C7.9-0.6 4.1-0.6 1.8 1.8c-2.3 2.3-2.3 6.1 0 8.5L22.7 31.2 1.8 52.2c-2.3 2.3-2.3 6.1 0 8.5C2.9 61.8 4.5 62.4 6 62.4s3.1-0.6 4.2-1.8L31.2 39.7l21 21c1.2 1.2 2.7 1.8 4.2 1.8s3.1-0.6 4.2-1.8c2.3-2.3 2.3-6.1 0-8.5L39.7 31.2z"/>
          </svg>
          Close
        </button>
        <div class="dpiBlog-viewer__container"></div>
      </div>
    `);
  }
  
  /**
  * Kick it off
  */
  function _init(idx) {
    if (!state.active && posts) {
      state.active = true;
      state.currentArticle = idx;
      _renderRoot();
      _cacheDom();
      _bindEvents();
      _renderArticle();
    } else {
      return false;
    }
    
    return true;
  }
  
  /**
  * Public methods
  */
  return {
    open(idx = 0) {
      return _init(idx);
    },
    close() {
      return _terminate();
    },
    prevArticle() {
      return _reRender('prev');
    },
    nextArticle() {
      return _reRender('next');
    }
  }
  
})(window.dpiBlogPosts);

document.querySelector('.render').addEventListener('click', () => window.dpiBlogViewer.open());
